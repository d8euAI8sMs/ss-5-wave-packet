\documentclass[12pt,a4paper]{article}
\usepackage{russ}
\usepackage[english,russian]{babel}
\usepackage{microtype}
\usepackage{csquotes}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtext}
\usepackage[notrig]{physics}
\usepackage{newfloat}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{subfig}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.PNG}
\graphicspath{{./img/}}
\captionsetup[figure]{justification=centering}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}
\DeclareCaptionLabelSeparator{dotseparator}{. }
\captionsetup{labelsep=dotseparator}

\newcommand{\Ltf}[0]{\Delta_{\theta,\varphi}}

\begin{document}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Постановка задачи}

        Исследовать эволюцию волнового пакета в сферической прямо-угольной потенциальной яме конечной глубины:
        %
        \begin{equation}
            U(r) = \begin{cases}
                - U_0 & 0 \le r \le a , \\
                    0 & r \ge a .
            \end{cases}
        \end{equation}
        %
        Использовать \enquote{открытые} граничные условия. Орбитальный момент не обязательно равен 0.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Физическая модель}

        Будем рассматривать финитное движение квантовой нерелятивистской частицы в сферически симметричной потенциальной яме.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Математическая модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Нестационарное уравнение Шредингера, начальные и граничные условия}

            Динамика волнового пакета $\Psi(r)$ описывается нестационарным уравнением Шредингера:
            %
            \begin{equation}\label{eq:schrodinger_raw}
                i \hbar \pdv{\Psi(\vb{r},t)}{t}
                    = \qty( - \frac{\hbar^2}{2m} \nabla^2 + U(r) ) \Psi(\vb{r},t) .
            \end{equation}
            %
            Граничные условия имеют вид: $\Psi(\infty,t) = 0$. В начальный момент времени $t = 0$ частица представляется в виде гауссова волнового пакета:
            %
            \begin{equation}\label{eq:initial_psi}
                \Psi(r,0) = \Psi_0 \exp \qty( - \frac{(r-a)^2}{4\sigma^2} ) ,
            \end{equation}
            %
            где $\Psi_0$ -- нормировочный множитель, $a$ и $\sigma^2$ -- среднее значение положения частицы и дисперсия положения частицы относительно среднего.

            Исключим из уравнения Шредингера угловую зависимость.

            Оператор Лапласа $\nabla^2 \equiv \Delta$ в сферической системе координат можно разложить на две независимые части:
            %
            \begin{equation}
                \Delta = \Delta_r + \frac{1}{r^2} \Ltf
                       = \frac{1}{r} \pdv[2]{r} r
                       + \frac{1}{r^2} \Ltf.
            \end{equation}
            %
            Собственными функциями $\Ltf$ являются так называемые сферические функции $Y_{lm}(\theta,\varphi)$:
            %
            \begin{equation}\label{eq:spherical_functions}
                \Ltf Y_{lm}(\theta,\varphi) = l(l+1) Y_{lm}(\theta,\varphi) .
            \end{equation}
            %
            Пользуясь этим, представим функцию $\Psi(\vb{r},t)$ в виде произведения $\Psi(\vb{r},t) = \Psi(r,t) Y_{lm}(\theta,\varphi)$. Подставляя это в исходное уравнение и деля на $Y_{lm}$, получим
            %
            \begin{equation}\begin{aligned}
                i \hbar \pdv{\Psi(r,t)}{t}
                    = \qty(
                        - \frac{\hbar^2}{2m} \qty(
                            \Delta_r + \frac{l (l + 1)}{r^2}
                        ) + U(r)
                    ) \Psi(r,t) .
            \end{aligned}\end{equation}
            %
            Введем новую функцию
            %
            \begin{equation}\label{eq:psi}
                \psi(r,t) = r \Psi(r,t) .
            \end{equation}
            %
            Подставляя ее в уравнение, получим окончательно
            %
            \begin{equation}\begin{aligned}\label{eq:schrodinger_final}
                \pdv{\psi(r,t)}{t}
                    = \frac{i}{\hbar} \qty(
                        \frac{\hbar^2}{2m} \pdv[2]{\psi(r,t)}{r} +
                        \qty(
                            \frac{\hbar^2}{2m} \frac{l (l + 1)}{r^2} - U(r)
                        ) \psi(r,t)
                    ) .
            \end{aligned}\end{equation}

            Угловая зависимость $Y_{lm}(\theta,\varphi)$ нам не интересна, поскольку она не зависит от вида потенциала $U(r)$. Поэтому будем решать полученное уравнение при указанных начальных и граничных условиях.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Спектр энергий и стационарные волновые функции}

            Поскольку потенциал $U(r)$ не зависит от времени, решение уравнения \autoref{eq:schrodinger_final} можно представить в виде разложения по собственным функциям оператора:
            %
            \begin{equation}
                \psi(r,t) = \sum\limits_n \psi_n(r) \exp \qty(
                    - i \frac{E_n}{\hbar} t
                ) ,
            \end{equation}
            %
            где $E_n$, $\psi_n(r)$ -- собственные значения энергии и собственные ненормированные стационарные волновые функции, соответствующие этим энергиям.

            Таким образом, $E_n$ и $\psi_n(r)$ могут быть получены через преобразование Фурье от $\psi(r,t)$. Численно задача поиска стационарных волновых функций и соответствующих им уровней энергий может быть решена следующим образом. Если в некоторой точке $r_0$ построить функцию времени $\psi(r_0,t)$, а затем применить к ней дискретное преобразование Фурье, получится набор пиков на частотах, соответствующих частотам экспонент, а значит собственным уровням энергий. Если теперь зафиксировать уровень энергии $E_n$ и рассматривать высоту пика на этом уровне как функцию от $r$, можно восстановить с точностью до нормировки волновую функцию, соответствующую этому уровню.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Численная модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Выбор единиц измерения}

            Введем безразмерные переменные
            %
            \begin{equation}
                x    = \frac{r}{r_0} ; \quad
                \tau = \frac{t}{t_0} ; \quad
                u    = \frac{u}{e_0} ; \quad
                p_0  = \sqrt{2me_0} .
            \end{equation}
            %
            Уравнение Шредингера \autoref{eq:schrodinger_final} в них принимает вид:
            %
            \begin{equation}
                \pdv{\psi(x,\tau)}{\tau}
                    = i \qty(
                        \frac{\hbar e_0 t_0}{(p_0 r_0)^2} \qty(
                            \pdv[2]{\psi(x,\tau)}{x} +
                            \frac{l (l + 1)}{x^2} \psi(x,\tau)
                        ) - \frac{e_0 t_0}{\hbar} U(x) \psi(x,\tau)
                    ) .
            \end{equation}
            %
            Выберем константы так, чтобы
            %
            \begin{equation}
                \frac{e_0 t_0}{\hbar} = 1 ; \quad
                \frac{\hbar e_0 t_0}{(p_0 r_0)^2} =
                    \qty(\frac{\hbar}{p_0 r_0})^2 = 1 .
            \end{equation}
            %
            Тогда при $e_0 = 1 \text{эВ}$, $r_0 = 1 \times 10^{-8} \text{см}$: $t_0 \approx 6.582 \times 10^{-16} \text{с}$.

            Уравнение Шредингера примет безразмерный вид
            %
            \begin{equation}\label{eq:schrodinger_dimensionless}
                \pdv{\psi(x,\tau)}{\tau}
                    = i \qty(
                        \pdv[2]{\psi(x,\tau)}{x} +
                        \frac{l (l + 1)}{x^2} \psi(x,\tau) -
                        U(x) \psi(x,\tau)
                    ) .
            \end{equation}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{\enquote{Свободные} граничные условия}

            Сложность прямого использования граничных условий на бесконечности заключается в том, что в качестве бесконечно удаленной точки приходится, пользуясь какими-либо соображениями о задаче, выбирать некоторую точку достаточно большой, но конечной удаленности. Такой подход не всегда применим, а неправильный выбор такой точки может влиять на решение задачи.

            Поэтому приходится строить такие граничные условия, которые бы имитировали открытое пространство. Такие условия называются открытыми, или свободными.

            Пусть задана ограниченная некоторым радиусом $a$ потенциальная яма $U(x)$, т.е. $U(x \ge a) = 0$, причем в точке $b > a$ удовлетворяются граничные условия на бесконечности: $\Psi(\infty,\tau) = \Psi(b,\tau) = 0$. Построим функцию $f(x)$:
            %
            \begin{equation}
                f(x) = \frac{1}{1 + i \gamma \sigma(x)} , \quad
                \gamma = \text{const} , \quad
                \sigma(x) = \begin{cases}
                    0         & x  <  a  \\
                    (x - a)^2 & x \ge a .
                \end{cases}
            \end{equation}
            %
            В дифференциальном уравнении произведем замену
            %
            \begin{equation}\label{eq:inf_conditions}
                \pdv{x} \rightarrow f(x) \pdv{x} .
            \end{equation}
            %
            Волновая функция будет поглощаться в слое $a < x < b$, а отражений от бесконечно высоких стенок $x = b$ ямы не будет.

            Перепишем \autoref{eq:schrodinger_dimensionless} с учетом \autoref{eq:inf_conditions}:
            %
            \begin{equation}\label{eq:schrodinger_free_space}
                \pdv{\psi(x,\tau)}{\tau}
                    = i \qty(
                        f(x) \pdv{x}(f(x)\pdv{\psi(x,\tau)}{x}) +
                        \qty(
                            \frac{l (l + 1)}{x^2} - U(x)
                        ) \psi(x,\tau)
                    ) .
            \end{equation}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Дискретная модель}

            Зададим сетку узлов, на которой произведем приведение уравнений к дискретному виду. Выберем $N$ узлов временн\'{о}й сетки, $0 = \tau_0 < \dots < \tau_{N-1}$, $\tau_{i+1} - \tau_i = \delta \tau$, и $M$ узлов пространственной сетки, $0 + \varepsilon = x_0 < \dots < x_M = b$. На этой сетке дискретизуем потенциал $U_k = U(x_k)$ и волновые функции $\psi^i_k = \psi(x_k,\tau_i)$. Производные представим в виде
            %
            \begin{equation}\begin{gathered}
                \begin{aligned}
                    \eval{\pdv{\psi(x,\tau)}{x}}_{x=x_k} & \approx
                        \delta_x \psi_k = \frac{\psi_{k+1} - \psi_{k-1}}{x_{k+1} - x_{k-1}} \\
                    \eval{\pdv[2]{\psi(x,\tau)}{x}}_{x=x_k} & \approx
                        \delta^2_x \psi_k = \frac{2}{x_{k+1} - x_{k-1}} \qty(
                            \frac{\psi_{k+1} - \psi_{k}}{x_{k+1} - x_{k}} -
                            \frac{\psi_{k} - \psi_{k-1}}{x_{k} - x_{k-1}}
                        ) \\
                    \eval{f(x) \pdv{x}(f(x)\pdv{\psi(x,\tau)}{x})}_{x=x_k} & \approx
                        \delta^2_{f,x} \psi_k =
                \end{aligned} \\
                \frac{2 f(x_k)}{x_{k+1} - x_{k-1}} \qty(
                    f(x_{k+1}) \frac{\psi_{k+1} - \psi_{k}}{x_{k+1} - x_{k}} -
                    f(x_{k-1}) \frac{\psi_{k} - \psi_{k-1}}{x_{k} - x_{k-1}}
                )
            \end{gathered}\end{equation}

            Проинтегрируем \autoref{eq:schrodinger_free_space} на интервале $\qty[\tau_{i-1}, \tau_i]$:
            %
            \begin{multline}
                \psi^i(x) = \psi^{i-1}(x) + \\ i \int\limits_{t_{i-1}}^{t_i} \qty(
                    f(x) \pdv{x}(f(x)\pdv{\psi(x,\tau)}{x}) +
                    \qty(
                        \frac{l (l + 1)}{x^2} - U(x)
                    ) \psi(x,\tau)
                ) \dd{x} .
            \end{multline}
            %
            Для интегрирования воспользуемся формулой трапеций:
            %
            \begin{equation}\label{eq:discrete_schrodinger}
                \psi^i_k = \psi^{i-1}_k + i \frac{\delta\tau}{2} \qty(
                    \delta^2_{f,x} \qty(\psi^i_k + \psi^{i-1}_k) +
                    \qty(\frac{l(l+1)}{x^2_k} - U_k) \qty(\psi^i_k + \psi^{i-1}_k)
                ) .
            \end{equation}
            %

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Метод сеточной прогонки}

            Можно показать, что \autoref{eq:discrete_schrodinger} может быть представлено в виде
            %
            \begin{equation}
                A_k \psi_{k-1}^i + B_k \psi_{k+1}^i + C_k \psi_k^i = D_k ,
            \end{equation}
            %
            где $A_k$, $B_k$, $C_k$, $D_k$ -- некоторые не зависящие от $\psi^i$ коэффициенты, $D_k$ зависит от $\psi^{i-1}$. Данная система уравнений относительно $\psi_k^i$ образует трехдиагональную матрицу.

            Можно также показать, что при граничных условиях, заданных в виде $\psi_0 = \mu_0 \psi_1 + \nu_0$, $\psi_M = \mu_M \psi_1 + \nu_M$, а также при предположении $\psi_{k-1} = \alpha_k \psi_k + \beta$ для решения задачи можно применить метод прогонки. На первом этапе метода рассчитываются все $\alpha_k$ и $\beta_k$:
            %
            \begin{equation}\begin{aligned}
                \alpha_1     &= \mu_0 , \quad
                \beta_1       = \nu_0 \\
                \alpha_{k+1} &= - \frac{B_k}{C_k + A_k \alpha_k} \\
                \beta_{k+1}  &= \frac{D_k - A_k \beta_k}{C_k + A_k \alpha_k} ,
            \end{aligned}\end{equation}
            %
            на втором -- в все $\psi_k^i$ в обратном порядке:
            %
            \begin{equation}\begin{aligned}
                \psi_M^i     &= \frac{\mu_M \beta_M + \nu_M}{1 - \mu_M \alpha_M} \\
                \psi_{k-1}^i &= \alpha_k \psi_k^i + \beta_k .
            \end{aligned}\end{equation}
            %

\end{document}
